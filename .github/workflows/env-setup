#!/bin/bash
graal_arch=$1
graal_ver="23.0.2"
graal_os="$( uname -s | tr "[:upper:]" "[:lower:]")"
graal_ar="graalvm-community-jdk-${graal_ver}_${graal_os}-${graal_arch}_bin.tar.gz"
graal_dir="$(pwd)/graalvm-community-openjdk-23.0.2+7.1"
graal_url="https://github.com/graalvm/graalvm-ce-builds/releases/download/jdk-23.0.2/${graal_ar}"

# Download Graal
curl -L "${graal_url}" | tar -xz
graal_bin="${graal_dir}/bin"
if [ ! -d "${graal_bin}" ]
then
    graal_bin="${graal_dir}/Contents/Home/bin"
fi
export PATH="${graal_bin}:${PATH}"
export GRAALVM_JAVA_HOME="$(dirname ${graal_bin})"
# Install native image
${graal_bin}/gu install native-image

